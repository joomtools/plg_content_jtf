var jtfUploadFile=function(e,t){for(var u=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=t?1e3:1024;if(Math.abs(e)<i)return e+" B";for(var r=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],n=-1;e/=i,++n,Math.abs(e)>=i&&n<r.length-1;);return e.toFixed(1)+" "+r[n]},d=window.Joomla||{},i=window.mimelite||{},c="",r="",n=e.querySelector(".allowedExt"),a=e.querySelector(".dragarea"),l=document.querySelector("#"+t.id),p=e.querySelector(".upload-list"),o=document.querySelector('label[for="'+t.id+'"'),s=l.getAttribute("accept").split(","),v=t.uploadMaxSize,e=d.Text._("JTF_JS_UPLOAD_ALLOWED_FILES_EXT",""),f=d.Text._("JTF_JS_UPLOAD_ERROR_MESSAGE_SIZE","").replace("%s",u(v)),_=d.Text._("JTF_JS_UPLOAD_ERROR_FILE_NOT_ALLOWED",""),g=0,E="";g<s.length;++g){var L=i.getType(s[g]),S=i.getExtension(s[g]);null===L&&(L=i.getTypes(s[g])),null!==(S=null===S?s[g].replace(".",""):S)&&(r+=(E=r?",":"")+S,"zip"===S)&&(c+=E+"application/x-zip-compressed"),null!==L&&(c+=(E=c?",":"")+L)}r=r.replace(/,/g," ."),c=c.replace(/,/g," "),n.innerHTML=e+r;function T(){o.classList.add("invalid"),o.setAttribute("aria-invalid",!0),null!==a&&a.classList.add("invalid"),l.classList.add("invalid"),l.setAttribute("aria-invalid",!0)}function A(){o.classList.remove("invalid"),o.setAttribute("aria-invalid",!1),null!==a&&a.classList.remove("invalid"),l.classList.remove("invalid"),l.setAttribute("aria-invalid",!1)}function B(e){for(var t={},i=[],r=[],n="",a="",e=(e=>{for(var t=0,i=0;i<e.length;i++)t+=e[i].size;return t})(t=(void 0!==e.originalEvent?e.originalEvent:e).target.files),l=0;l<t.length;l++){var o,s="<strong>"+(o=t[l]).name+"</strong> ";i.push("<li>"+s+"("+u(o.size)+")</li>"),(e=>!(!e||!new RegExp(e).test(c)))(o.type)||r.push(s+"- "+_)}v<e&&r.push("<li><strong>"+u(e)+"</strong> - "+f+"</li>"),0<i.length&&(n=d.Text._("JTF_JS_UPLOAD_LIST_WRAPPER_"+jtfFrwk,"").replace("%s","<ol>"+i.join("")+"</ol>"),A(),document.formvalidator.setHandler("file",function(){return!0})),0<r.length&&(a=d.Text._("JTF_JS_ERROR_WRAPPER_"+jtfFrwk,"").replace("%s",r.join("<br />")),T(),document.formvalidator.setHandler("file",function(){return!1})),p.innerHTML=a+n}var m;o&&a&&(m=o.classList.contains("invalid"),new MutationObserver(function(e){e.forEach(function(e){"class"===e.attributeName&&(e=e.target.classList.contains("invalid"),m!==e)&&((m=e)?T:A)()})}).observe(o,{attributes:!0})),void 0!==l&&l.addEventListener("change",function(e){e.preventDefault(),e.stopPropagation(),B(e)},!1)},jtfFrwk=window.jtfFrwk||"BS2";document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".uploader-wrapper");Array.prototype.forEach.call(e,function(e){jtfUploadFile(e,{id:e.querySelector('input[type="file"].file-uplaoder').getAttribute("id"),uploadMaxSize:e.querySelector('input[type="hidden"].file-uplaoder').getAttribute("value")})})});