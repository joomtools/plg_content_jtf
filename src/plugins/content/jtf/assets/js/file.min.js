"use strict";domIsReady(function(){var jtfUploadFile=function(elm,optionlist){for(var acceptedType="",acceptedExt="",dragZone=elm.querySelector(".dragarea"),allowedExt=elm.querySelector(".allowedExt"),fileInput=document.querySelector("#"+optionlist.id),uploadList=elm.querySelector(".upload-list"),label=document.querySelector('label[for="'+optionlist.id+'"'),accept=fileInput.getAttribute("accept").split(","),maxsize=optionlist.uploadMaxSize,msgAllowedExt=Joomla.JText._("JTF_UPLOAD_ALLOWED_FILES_EXT",""),errorFileSize=Joomla.JText._("JTF_UPLOAD_ERROR_MESSAGE_SIZE",""),errorFileType=Joomla.JText._("JTF_UPLOAD_ERROR_FILE_NOT_ALLOWED",""),i=0,sep="";i<accept.length;++i){var mimeType=mimelite.getType(accept[i].replace(".","")),fileExt=mimelite.getExtension(accept[i].replace(".",""));null===mimeType&&(mimeType=mimelite.getTypes(accept[i].replace(".",""))),null===fileExt&&(fileExt=accept[i].replace(".","")),null!==fileExt&&(acceptedExt+=(sep=acceptedExt?",":"")+fileExt,"zip"===fileExt&&(acceptedType+=sep+"application/x-zip-compressed")),null!==mimeType&&(acceptedType+=(sep=acceptedType?",":"")+mimeType)}function allowedFile(fileType){if(fileType&&new RegExp(fileType).test(acceptedType))return 1}function humanReadableSize(bytes,si){var thresh=si?1e3:1024;if(Math.abs(bytes)<thresh)return bytes+" B";for(var units=si?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],u=-1;bytes/=thresh,++u,Math.abs(bytes)>=thresh&&u<units.length-1;);return bytes.toFixed(1)+" "+units[u]}function dateiauswahl(elm){for(var files={},output=[],uploadError="",uploadsize=function(files){for(var size=0,_i=0,f=files[_i];_i<files.length;_i++)size+=f.size;return size}(files=void 0!==elm.originalEvent?elm.originalEvent.target.files:elm.target.files),_i2=0,f=files[_i2];_i2<files.length;_i2++)allowedFile(f.type)?output.push("<li><strong>Upload: ",f.name,"</strong> (",humanReadableSize(f.size,!0),")</li>"):uploadError+="<p><strong>Error: "+f.name+"</strong> - "+errorFileType+"</p>";maxsize<uploadsize&&(uploadError+="<p><strong>Error: "+humanReadableSize(uploadsize,!0)+"</strong> - "+errorFileSize+"</p>"),uploadError?(label.classList.add("invalid"),label.setAttribute("aria-invalid",!0),dragZone.classList.add("invalid"),dragZone.setAttribute("aria-invalid",!0),fileInput.classList.add("invalid"),fileInput.setAttribute("aria-invalid",!0),document.formvalidator.setHandler("file",function(){return!1})):(label.classList.remove("invalid"),label.setAttribute("aria-invalid",!1),dragZone.classList.remove("invalid"),dragZone.setAttribute("aria-invalid",!1),fileInput.classList.remove("invalid"),fileInput.setAttribute("aria-invalid",!1),document.formvalidator.setHandler("file",function(){return!0})),uploadList.innerHTML=uploadError+'<ul style="text-align: left;">'+output.join("")+"</ul>"}acceptedExt="."+acceptedExt.replace(/,/g," ."),acceptedType=acceptedType.replace(/,/g," "),allowedExt.innerHTML=msgAllowedExt+acceptedExt,void 0!==fileInput&&(fileInput.addEventListener("drag dragstart dragend dragover dragenter dragleave change",function(e){e.preventDefault(),e.stopPropagation()}),fileInput.addEventListener("dragenter dragover",function(e){dragZone.classList.add("hover")}),fileInput.addEventListener("dragleave dragend drop",function(e){dragZone.classList.remove("hover")}),fileInput.addEventListener("change",function(e){dateiauswahl(e)}))},uploaderWrapper=document.querySelectorAll(".uploader-wrapper");Array.prototype.forEach.call(uploaderWrapper,function(elm){jtfUploadFile(elm,{id:elm.querySelector('.legacy-uploader input[type="file"]').getAttribute("id"),uploadMaxSize:elm.querySelector('.legacy-uploader input[type="hidden"]').getAttribute("value")})})});